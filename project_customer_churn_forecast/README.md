# Project Customer Churn Prediction

Проект направлен на разработку модели машинного обучения для предсказания оттока клиентов телеком-компании.  
Это позволит бизнесу удерживать абонентов и снижать потери.

# Результат:
**Разработана модель CatBoostClassifier с ROC-AUC 0.868 на кросс-валидации. Accuracy > 0.85.**

---

## Описание проекта

В рамках проекта проведены:
- Загрузка и объединение нескольких датасетов клиента.
- Предобработка: преобразование типов, переименование признаков, заполнение пропусков.
- Исследовательский анализ данных (EDA) с построением распределений и анализом корреляций.
- Создание новых признаков (длительность договора, отношение расходов, количество интернет-опций и др.).
- Обучение и сравнение нескольких моделей (Logistic Regression, KNN, CatBoost).
- Анализ важности признаков с помощью SHAP.

---

## Цели проекта

- **Обучить модель классифицировать клиентов на ушедших и оставшихся.**
- **Важные критерии:**
  - Метрика *ROC-AUC* не меньше 0.85.
  - Метрика *Accuracy* выше 0.80.

---

## Описание данных

От заказчика получены 4 датасета:
- `contract_new` — договоры клиентов.
- `personal_new` — персональная информация.
- `internet_new` — подключенные интернет-услуги.
- `phone_new` — информация о телефонии.

Данные объединены в единую таблицу. Пропусков и дубликатов нет, проведена корректировка типов.

---

## Стек

`pandas`, `numpy`, `matplotlib`, `seaborn`, `plotly`, `scikit-learn`, `catboost`, `lightgbm`, `shap`

---

## Результаты

1. **EDA выявил:**
   - Дисбаланс классов: 15.6% клиентов ушли.
   - Чаще уходят абоненты с большим сроком договора, высокими ежемесячными расходами, пенсионеры, а также те, кто использует электронный чек и автоплатежи.
   - Составлен портрет клиента в оттоке.

2. **Фичи:**
   - Добавлены новые признаки: `duration`, `month_to_total`, `log_total_charges`, агрегаты по интернет-опциям.
   - Удалены скоррелированные и неинформативные признаки.

3. **Модели:**
   - Logistic Regression ROC-AUC = 0.807
   - KNN ROC-AUC = 0.737
   - CatBoostClassifier ROC-AUC = **0.868** (лучший результат).

4. **Интерпретация модели:**
   - Наиболее значимые признаки: `duration`, `month_to_total`, `log_total_charges`, тип контракта, наличие партнера.

---

## Рекомендации для бизнеса

- Внимательно работать с клиентами, находящимися более 3 лет в компании и с высокими ежемесячными расходами.
- Обратить внимание на пенсионеров и клиентов с автосписаниями.
- Усилить сбор данных: история тарифов, платежей, опций, удовлетворенность услугами.
- Использовать ансамбли бустингов или нейросети для дальнейшего повышения качества.

---

## Итог

**Построена модель предсказания оттока с ROC-AUC > 0.85.**  
Модель готова для внедрения в процессы компании для удержания клиентов.
