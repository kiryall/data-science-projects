# Pregnancy Risk Prediction Model

Проект направлен на разработку прогностической модели машинного обучения для оценки рисков при беременности. Это позволит медицинским специалистам своевременно выявлять пациенток с высоким риском осложнений и принимать профилактические меры.

## Результат
Разработана модель LightGBM с F1-score 0.859 на тестовой выборке. Модель демонстрирует высокую точность предсказания критически важного класса "high risk" (91%).

## Описание проекта
В рамках проекта проведены:

- Загрузка и предобработка медицинских данных беременных
- Преобразование признаков (snake_case, обработка выбросов)
- Исследовательский анализ данных (EDA) с построением распределений и визуализаций
- Создание новых признаков (возрастные группы, разность артериального давления)
- Обучение и сравнение моделей (Logistic Regression, LightGBM)
- Оптимизация гиперпараметров с помощью Optuna
- Анализ важности признаков с помощью SHAP

## Цели проекта
Обучить модель классифицировать беременных по трем уровням риска:
- **low risk** - низкий риск
- **mid risk** - средний риск  
- **high risk** - высокий риск

### Критерии успеха:
- Метрика F1-score (weighted) не менее 0.80
- Максимальная точность для класса "high risk" (минимализация ложноотрицательных прогнозов)

## Описание данных
Датасет содержит медицинские показатели беременных женщин:
- `age` - возраст
- `systolic_bp` - систолическое артериальное давление
- `diastolic_bp` - диастолическое артериальное давление  
- `BS` - уровень глюкозы в крови
- `body_temp` - температура тела
- `heart_rate` - частота сердечных сокращений
- `risk_level` - уровень риска (таргет)

Данные чистые, без пропусков. Обнаружен и удален один выброс в признаке `heart_rate`.

## Стек технологий
`pandas`, `numpy`, `matplotlib`, `seaborn`, `plotly`, `scikit-learn`, `lightgbm`, `optuna`, `shap`, `phik`, `ydata-profiling`

## Результаты анализа

### EDA выявил:
- **Дисбаланс классов**: распределение рисков сбалансировано
- **Возрастной фактор**: женщины старше 40 лет имеют повышенные риски
- **Глюкоза**: уровень выше 8 ммоль/л ассоциирован с высоким риском
- **Давление**: повышенные значения systolic_bp и diastolic_bp коррелируют с рисками
- **Пульс и температура**: учащенный пульс и повышенная температура увеличивают вероятность осложнений

### Портрет пациентки с высоким риском:
- В среднем на 10 лет старше женщин с низким риском
- Уровень глюкозы выше на 5 единиц
- Повышенное артериальное давление
- Учащенный пульс

### Новые признаки:
- `age_group` - возрастные категории (young/mid/old)
- `body_pressure` - разность systolic и diastolic давления

## Моделирование

### Baseline модель:
- **Logistic Regression**: F1-score = 0.807

### Лучшая модель:
- **LightGBM**: F1-score = 0.859 (тест)

### Прирост качества:
+0.132 по сравнению с baseline

## Интерпретация модели

### Важные признаки (SHAP анализ):
1. **BS** - уровень глюкозы в крови (наибольший вклад)
2. **systolic_bp** - систолическое давление
3. **age** - возраст
4. **body_temp** - температура тела
5. **heart_rate** - частота пульса

Признак `age_group` показал низкую важность и может быть исключен в будущих итерациях.

## Матрицы ошибок

### Сильные стороны модели:
- **Высокая точность для high risk**: 91% (критически важный класс)
- **Хорошее определение mid risk**: 89%
- **Минимальные опасные ошибки**: всего 1.5% high risk случаев предсказаны как low risk

### Области для улучшения:
- **Low risk класс**: точность 79-80%
- **Перестраховка**: 19-20% low risk случаев определяются как mid risk

## Рекомендации для медицинских специалистов

1. **Приоритетный мониторинг** пациенток с уровнем глюкозы > 8 ммоль/л
2. **Усиленное наблюдение** за женщинами с повышенным артериальным давлением
3. **Внимание к возрастной группе** 40+ лет
4. **Контроль показателей** пульса и температуры тела

## Дальнейшее развитие

1. **Сбор дополнительных данных**: история беременностей, наследственные факторы, образ жизни
2. **Временные ряды**: динамическое отслеживание показателей в течение беременности
3. **Дополнительные модели**: ансамбли, нейросети для повышения точности low risk класса
4. **Разработка API** для интеграции в медицинские информационные системы

## Итог
Построена эффективная модель прогнозирования рисков при беременности с F1-score > 0.8. Модель готова для пилотного внедрения в клиническую практику для поддержки принятия врачебных решений и улучшения исходов беременности.
