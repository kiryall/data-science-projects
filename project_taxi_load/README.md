# Проект: Прогнозирование заказов такси

Компания собрала исторические данные о заказах такси в аэропортах. Чтобы привлекать больше водителей в периоды пиковой нагрузки, необходимо спрогнозировать количество заказов такси на следующий час.

## Цель проекта

Разработать модель для **прогнозирования количества заказов такси на час вперёд**.

> **Ключевой критерий качества:**  
> Значение метрики **RMSE на тестовой выборке должно быть не больше 48**.

---

## Описание данных

Исходный файл: `taxi.csv`

| Признак     | Описание                                 |
|-------------|------------------------------------------|
| `datetime`  | Дата и время регистрации заказа          |
| `num_orders`| Количество заказов такси в этот момент   |

---

## Используемые библиотеки

- `pandas`, `numpy` — для работы с данными  
- `matplotlib`, `seaborn` — визуализация  
- `sklearn` — модели машинного обучения  
- `statsmodels` — анализ временных рядов

---

## Результаты

### Предобработка

- Аномалии и критические ошибки в данных **не выявлены**
- Проведено **ресемплирование по одному часу**
- Данные готовы к анализу и моделированию

### EDA (исследовательский анализ)

- **Общий тренд** — рост количества заказов с марта по август
- **Суточная сезонность** — пик заказов с **23:00 до 01:00**, минимум — в **5–6 утра**
- **Недельная сезонность** — больше всего заказов **в пятницу и в ночь с воскресенья на понедельник**
- Временной ряд **нестационарный**, что важно учитывать при построении моделей

### Моделирование

- Созданы временные признаки: `hour`, `day_of_week`, лаги и скользящие средние
- Рассмотрены 4 модели. Результаты кросс-валидации:

| Модель                 | RMSE |
|------------------------|------:|
| `ElasticNet`           | **24.37** |
| `SVR`                  | 24.57 |
| `KNeighborsRegressor`  | 26.01 |
| `DecisionTreeRegressor`| 26.94 |

- **Выбрана модель: ElasticNet**
- RMSE на тестовой выборке: **34.26**
- Модель уловила тренд и сезонность, точно предсказывала заказы до 2018-08-27
- Не смогла предсказать аномальные всплески (единичные пики)
- **Модель работает лучше, чем средние и сезонные эвристики**

## Рекомендации

1. **Собрать дополнительные признаки**, влияющие на спрос:
   - Аэропорт отправления/прибытия
   - Расписание рейсов
   - Погодные условия
   - Массовые мероприятия

2. **Периодически дообучать модель** на новых данных

3. **Рассмотреть более сложные модели**:
   - временные ряды (ARIMA, Prophet)
   - нейросети (LSTM, TCN)

4. Ввести **штрафы в метрике** за недооценку спроса (недостаток водителей)

>## Итог: 
> Разработана модель `ElasticNet`, способная с хорошей точностью предсказывать количество заказов такси на следующий час (RMSE = **34.26**). Проект готов для внедрения и дальнейшего улучшения.